(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{1891:function(e,t){e.exports="images/sumra/eye.f0a2cf8.svg"},1893:function(e,t){e.exports="vector-icons/icon-logout.8faa23b.svg"},1897:function(e,t){e.exports="vector-icons/icon-enter.197efca.svg"},1898:function(e,t){e.exports="vector-icons/icon-person.95d133c.svg"},1899:function(e,t){e.exports="vector-icons/icon-person-orange.51c0148.svg"},1900:function(e,t){e.exports="vector-icons/icon-block.d2a60c2.svg"},1901:function(e,t){e.exports="vector-icons/icon-check-green.9f6bf49.svg"},1906:function(e,t){e.exports="images/sumra/messengers/Telegram.e4270a5.svg"},1907:function(e,t){e.exports="images/sumra/messengers/Viber.08b8b77.svg"},1908:function(e,t){e.exports="images/sumra/messengers/Messanger.b122910.svg"},1909:function(e,t){e.exports="images/sumra/messengers/WhatsApp.c59e1fb.svg"},1910:function(e,t){e.exports="images/sumra/messengers/Signal.6874d60.svg"},1911:function(e,t){e.exports="images/sumra/messengers/Line.219dd30.svg"},1912:function(e,t){e.exports="images/sumra/messengers/Discord.06bfea5.svg"},1913:function(e,t){e.exports="images/sumra/messengers/Groupme.0c182e3.svg"},1914:function(e,t){e.exports="images/sumra/messengers/WeChat.ba34459.svg"},1915:function(e,t){e.exports="images/sumra/messengers/Snapchat.afda2fe.svg"},1916:function(e,t){e.exports="vector-icons/send.52eddd3.svg"},1918:function(e,t){e.exports="images/sumra/slide-1-min.6b0ae95.png"},1919:function(e,t){e.exports="images/sumra/slide-2-min.0cf2a6d.png"},1920:function(e,t){e.exports="images/sumra/Combined Shape.f809bbf.svg"},2064:function(e,t){const a=indexedDB.open("matrix-js-sdk:crypto",10);function r(e,t){if(console.log("Upgrading IndexedDBCryptoStore from version "+t+" to 10"),t<1&&function(e){const t=e.createObjectStore("outgoingRoomKeyRequests",{keyPath:"requestId"});t.createIndex("session",["requestBody.room_id","requestBody.session_id"]),t.createIndex("state","state")}(e),t<2&&e.createObjectStore("account"),t<3){e.createObjectStore("sessions",{keyPath:["deviceKey","sessionId"]}).createIndex("deviceKey","deviceKey")}if(t<4&&e.createObjectStore("inbound_group_sessions",{keyPath:["senderCurve25519Key","sessionId"]}),t<5&&e.createObjectStore("device_data"),t<6&&e.createObjectStore("rooms"),t<7&&e.createObjectStore("sessions_needing_backup",{keyPath:["senderCurve25519Key","sessionId"]}),t<8&&e.createObjectStore("inbound_group_sessions_withheld",{keyPath:["senderCurve25519Key","sessionId"]}),t<9){e.createObjectStore("session_problems",{keyPath:["deviceKey","time"]}).createIndex("deviceKey","deviceKey"),e.createObjectStore("notified_error_devices",{keyPath:["userId","deviceId"]})}t<10&&e.createObjectStore("shared_history_inbound_group_sessions",{keyPath:["roomId"]})}a.onupgradeneeded=e=>{r(e.target.result,e.oldVersion)},a.onblocked=()=>{console.log("can't yet open LocalIndexedDBStoreBackend because it is open elsewhere")},console.log("LocalIndexedDBStoreBackend.connect: awaiting connection..."),a.onsuccess=e=>{r(e.target.result,1),console.log("connected to indexeddb "+this._dbName)}},2088:function(e,t,a){"use strict";a.r(t),a.d(t,"components",(function(){return Ke}));var r=a(157),s=a.n(r),n=a(1065),o=a(377),i=a.n(o),l=a(82);class c extends n.a{translate(e){return e=(e=i()(Object(l.a)(e))).replace(/\[matrix\]/,'<a href="https://matrix.org" target="_blank" rel="noreferrer noopener"><img width="79" height="34" alt="Matrix" style="padding-left: 1px;vertical-align: middle" src="welcome/images/matrix.svg"/></a>')}}s()(c,"replaces","EmbeddedPage");var m=a(81),u=a.n(m),h=a(250),d=a(92),p=a(282),g=a(258),b=a(257),v=a.n(b),f=a(114),y=a(87),E=a(117),w=a(113),C=a(1887),_=a.n(C),S=a(1888),x=a.n(S),P=a(1890),O=a(88),N=a(98);const k=e=>{let{matrixClient:t,loginType:r,fragmentAfterLogin:s,idp:n,primary:o,mini:i}=e,c=x()(e,["matrixClient","loginType","fragmentAfterLogin","idp","primary","mini"]);const m=n?Object(l.a)("Continue with %(provider)s",{provider:n.name}):Object(l.a)("Sign in with single sign-on"),d=O.getComponent("views.elements.AccessibleTooltipButton"),p=O.getComponent("views.elements.AccessibleButton"),g=()=>{f.a.get().startSingleSignOn(t,r,s,null==n?void 0:n.id)};let b,y;const E=n?(e=>{switch(e){case h.a.Apple:return a(1021);case h.a.Facebook:return a(1022);case h.a.Github:return a(1023);case h.a.Gitlab:return a(1024);case h.a.Google:return a(1025);case h.a.Twitter:return a(1026);default:return null}})(n.brand):null;if(E){const e=n.brand.split(".").pop();y="mx_SSOButton_brand_"+e,b=u.a.createElement("img",{src:E,height:"24",width:"24",alt:e})}else if("string"==typeof(null==n?void 0:n.icon)&&n.icon.startsWith("mxc://")){const e=Object(N.b)(n.icon,t).getSquareThumbnailHttp(24);b=u.a.createElement("img",{src:e,height:"24",width:"24",alt:n.name})}const w=v()("mx_SSOButton",{[y]:y,mx_SSOButton_mini:i,mx_SSOButton_default:!n,mx_SSOButton_primary:o});return i?u.a.createElement(d,_()({},c,{title:m,className:w,onClick:g}),b):u.a.createElement(p,_()({},c,{className:w,onClick:g}),b,m)};var j=({matrixClient:e,flow:t,loginType:a,fragmentAfterLogin:r,primary:s})=>{const n=t["org.matrix.msc2858.identity_providers"]||[];if(n.length<2)return u.a.createElement("div",{className:"sumra-Button"},u.a.createElement(k,{matrixClient:e,loginType:a,fragmentAfterLogin:r,idp:n[0],primary:s}));const o=Math.ceil(n.length/6),i=Math.ceil(n.length/o);return u.a.createElement("div",{className:"sumra-Button"},Object(P.chunk)(n,i).map(t=>u.a.createElement("div",{key:t[0].id,className:"sumra-Button"},t.map(t=>u.a.createElement(k,{key:t.id,matrixClient:e,loginType:a,fragmentAfterLogin:r,idp:t,mini:!0,primary:s})))))},I=a(428),L=a.n(I);class T extends m.Component{render(){return u.a.createElement("div",{className:"sumra-auth-logo"},u.a.createElement("a",{href:"/#/welcome"},u.a.createElement("img",{src:L.a,alt:"logo"})))}}function F(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function U(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?F(Object(a),!0).forEach((function(t){s()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):F(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}Object(l.b)("Invalid homeserver discovery response"),Object(l.b)("Failed to get autodiscovery configuration from server"),Object(l.b)("Invalid base_url for m.homeserver"),Object(l.b)("Homeserver URL does not appear to be a valid Matrix homeserver"),Object(l.b)("Invalid identity server discovery response"),Object(l.b)("Invalid base_url for m.identity_server"),Object(l.b)("Identity server URL does not appear to be a valid identity server"),Object(l.b)("General failure");class B extends u.a.PureComponent{constructor(e){super(e),s()(this,"unmounted",!1),s()(this,"loginLogic",void 0),s()(this,"stepRendererMap",void 0),s()(this,"isBusy",()=>this.state.busy||this.props.busy),s()(this,"onPasswordLogin",async(e,t,a,r)=>{if(!this.state.serverIsAlive){this.setState({busy:!0});let e=!0;try{await g.a.validateServerConfigWithStaticUrls(this.props.serverConfig.hsUrl,this.props.serverConfig.isUrl),this.setState({serverIsAlive:!0,errorText:""})}catch(t){const a=g.a.authComponentStateForError(t);this.setState(U({busy:!1,busyLoggingIn:!1},a)),e=!a.serverErrorIsFatal}if(!e)return}this.setState({busy:!0,busyLoggingIn:!0,errorText:null,loginIncorrect:!1}),this.loginLogic.loginViaPassword(e,t,a,r).then(e=>{this.setState({serverIsAlive:!0}),this.props.onLoggedIn(e,r)},t=>{if(this.unmounted)return;let a;const r=e.indexOf("@")>0;if(400===t.httpStatus&&r)a=Object(l.a)("This homeserver does not support login using email address.");else if("M_RESOURCE_LIMIT_EXCEEDED"===t.errcode){const e=Object(p.a)(t.data.limit_type,t.data.admin_contact,{monthly_active_user:Object(l.b)("This homeserver has hit its Monthly Active User limit."),hs_blocked:Object(l.b)("This homeserver has been blocked by it's administrator."),"":Object(l.b)("This homeserver has exceeded one of its resource limits.")}),r=Object(p.a)(t.data.limit_type,t.data.admin_contact,{"":Object(l.b)("Please <a>contact your service administrator</a> to continue using this service.")});a=u.a.createElement("div",null,u.a.createElement("div",null,e),u.a.createElement("div",{className:"mx_Login_smallError"},r))}else a=401===t.httpStatus||403===t.httpStatus?"M_USER_DEACTIVATED"===t.errcode?Object(l.a)("This account has been deactivated."):d.a.get().disable_custom_urls?u.a.createElement("div",null,u.a.createElement("div",null,Object(l.a)("Incorrect username and/or password.")),u.a.createElement("div",{className:"mx_Login_smallError"},Object(l.a)("Please note you are logging into the %(hs)s server, not matrix.org.",{hs:this.props.serverConfig.hsName}))):Object(l.a)("Incorrect username and/or password."):this.errorTextFromError(t);this.setState({busy:!1,busyLoggingIn:!1,errorText:a,loginIncorrect:401===t.httpStatus||403===t.httpStatus})})}),s()(this,"onUsernameChanged",e=>{this.setState({username:e})}),s()(this,"onUsernameBlur",async e=>{const t="@"===e[0];if(this.setState({username:e,busy:t,errorText:null,canTryLogin:!0}),t){const t=e.split(":").slice(1).join(":");try{const e=await g.a.validateServerName(t);this.props.onServerConfigChange(e),this.setState({busy:!1})}catch(e){console.error("Problem parsing URL or unhandled error doing .well-known discovery:",e);let t=Object(l.a)("Failed to perform homeserver discovery");e.translatedMessage&&(t=e.translatedMessage);let a=t,r={};g.a.isLivelinessError(e)&&(a=this.state.errorText,r=g.a.authComponentStateForError(e)),this.setState(U({busy:!1,errorText:a},r))}}}),s()(this,"onPhoneCountryChanged",e=>{this.setState({phoneCountry:e})}),s()(this,"onPhoneNumberChanged",e=>{this.setState({phoneNumber:e})}),s()(this,"onRegisterClick",e=>{e.preventDefault(),e.stopPropagation(),this.props.onRegisterClick()}),s()(this,"onTryRegisterClick",e=>{var t,a;const r=null===(t=this.state.flows)||void 0===t?void 0:t.find(e=>"m.login.password"===e.type),s=null===(a=this.state.flows)||void 0===a?void 0:a.find(e=>"m.login.sso"===e.type||"m.login.cas"===e.type);if(s&&!r){e.preventDefault(),e.stopPropagation();const t="m.login.sso"===s.type?"sso":"cas";f.a.get().startSingleSignOn(this.loginLogic.createTemporaryClient(),t,this.props.fragmentAfterLogin)}else this.onRegisterClick(e)}),s()(this,"isSupportedFlow",e=>!!this.stepRendererMap[e.type]||(console.log("Skipping flow",e,"due to unsupported login type",e.type),!1)),s()(this,"renderPasswordStep",()=>{const e=O.getComponent("views.auth.PasswordLogin");return u.a.createElement(e,{onSubmit:this.onPasswordLogin,username:this.state.username,phoneCountry:this.state.phoneCountry,phoneNumber:this.state.phoneNumber,onUsernameChanged:this.onUsernameChanged,onUsernameBlur:this.onUsernameBlur,onPhoneCountryChanged:this.onPhoneCountryChanged,onPhoneNumberChanged:this.onPhoneNumberChanged,onForgotPasswordClick:this.props.onForgotPasswordClick,loginIncorrect:this.state.loginIncorrect,serverConfig:this.props.serverConfig,disableSubmit:this.isBusy(),busy:this.props.isSyncing||this.state.busyLoggingIn})}),s()(this,"renderSsoStep",e=>{const t=this.state.flows.find(t=>t.type==="m.login."+e);return u.a.createElement(j,{matrixClient:this.loginLogic.createTemporaryClient(),flow:t,loginType:e,fragmentAfterLogin:this.props.fragmentAfterLogin,primary:!this.state.flows.find(e=>"m.login.password"===e.type)})}),this.state={busy:!1,busyLoggingIn:null,errorText:null,loginIncorrect:!1,canTryLogin:!0,flows:null,username:"",phoneCountry:null,phoneNumber:"",serverIsAlive:!0,serverErrorIsFatal:!1,serverDeadError:""},this.stepRendererMap={"m.login.password":this.renderPasswordStep,"m.login.cas":()=>this.renderSsoStep("cas"),"m.login.sso":()=>this.renderSsoStep("sso")},w.a.instance.track("onboarding_login_begin")}UNSAFE_componentWillMount(){this.initLoginLogic(this.props.serverConfig)}componentWillUnmount(){this.unmounted=!0}UNSAFE_componentWillReceiveProps(e){e.serverConfig.hsUrl===this.props.serverConfig.hsUrl&&e.serverConfig.isUrl===this.props.serverConfig.isUrl||this.initLoginLogic(e.serverConfig)}async initLoginLogic({hsUrl:e,isUrl:t}){let a=!1;this.props.serverConfig.isDefault&&e===this.props.serverConfig.hsUrl&&t===this.props.serverConfig.isUrl&&(a=!0);const r=a?this.props.fallbackHsUrl:null,s=new h.b(e,t,r,{defaultDeviceDisplayName:this.props.defaultDeviceDisplayName});this.loginLogic=s,this.setState({busy:!0,loginIncorrect:!1});try{const{warning:a}=await g.a.validateServerConfigWithStaticUrls(e,t);a?this.setState(U(U({},g.a.authComponentStateForError(a)),{},{errorText:""})):this.setState({serverIsAlive:!0,errorText:""})}catch(e){this.setState(U({busy:!1},g.a.authComponentStateForError(e)))}s.getFlows().then(e=>{const t=e.filter(this.isSupportedFlow);t.length>0?this.setState({flows:t}):this.setState({errorText:Object(l.a)("This homeserver doesn't offer any login flows which are supported by this client.")})},e=>{this.setState({errorText:this.errorTextFromError(e),loginIncorrect:!1,canTryLogin:!1})}).finally(()=>{this.setState({busy:!1})})}errorTextFromError(e){let t=e.errcode;!t&&e.httpStatus&&(t="HTTP "+e.httpStatus);let a=Object(l.a)("There was a problem communicating with the homeserver, please try again later.")+(t?" ("+t+")":"");return"rejected"===e.cors&&(a="https:"!==window.location.protocol||!this.props.serverConfig.hsUrl.startsWith("http:")&&this.props.serverConfig.hsUrl.startsWith("http")?u.a.createElement("span",null,Object(l.a)("Can't connect to homeserver - please check your connectivity, ensure your <a>homeserver's SSL certificate</a> is trusted, and that a browser extension is not blocking requests.",{},{a:e=>u.a.createElement("a",{target:"_blank",rel:"noreferrer noopener",href:this.props.serverConfig.hsUrl},e)})):u.a.createElement("span",null,Object(l.a)("Can't connect to homeserver via HTTP when an HTTPS URL is in your browser bar. Either use HTTPS or <a>enable unsafe scripts</a>.",{},{a:e=>u.a.createElement("a",{target:"_blank",rel:"noreferrer noopener",href:"https://www.google.com/search?&q=enable%20unsafe%20scripts"},e)}))),a}renderLoginComponentForFlows(){if(!this.state.flows)return null;const e=["m.login.password"].map(e=>this.state.flows.find(t=>t.type===e)).filter(Boolean);return u.a.createElement(u.a.Fragment,null,e.map(e=>{const t=this.stepRendererMap[e.type];return u.a.createElement(u.a.Fragment,{key:e.type},t())}))}render(){const e=O.getComponent("auth.AuthBody"),t=O.getComponent("views.auth.AuthPage"),a=O.getComponent("views.elements.InlineSpinner"),r=O.getComponent("views.elements.Spinner"),s=(O.getComponent("views.elements.ServerPicker"),this.isBusy()&&!this.state.busyLoggingIn?u.a.createElement("div",{className:"mx_Login_loader"},u.a.createElement(r,null)):null),n=this.state.errorText;let o,i,c;if(n&&(o=u.a.createElement("div",{className:"mx_Login_error"},n)),!this.state.serverIsAlive){const e=v()({mx_Login_error:!0,mx_Login_serverError:!0,mx_Login_serverErrorNonFatal:!this.state.serverErrorIsFatal});i=u.a.createElement("div",{className:e},this.state.serverDeadError)}return this.props.isSyncing||this.state.busyLoggingIn?c=u.a.createElement("div",{className:"mx_AuthBody_paddedFooter"},u.a.createElement("div",{className:"mx_AuthBody_paddedFooter_title"},u.a.createElement(a,{w:20,h:20}),this.props.isSyncing?Object(l.a)("Syncing..."):Object(l.a)("Signing In...")),this.props.isSyncing&&u.a.createElement("div",{className:"mx_AuthBody_paddedFooter_subtitle"},Object(l.a)("If you've joined lots of rooms, this might take a while"))):y.b.getValue(E.a.Registration)&&(c=u.a.createElement("span",{className:"mx_AuthBody_changeFlow"},Object(l.a)("New? <a>Create account</a>",{},{a:e=>u.a.createElement("a",{onClick:this.onTryRegisterClick,href:"#"},e)}))),u.a.createElement(t,null,u.a.createElement(e,null,u.a.createElement(T,null),u.a.createElement("div",{className:"authentification-form"},u.a.createElement("h1",{className:"h1-title"},Object(l.a)("Login with Sumra ID"),s),o,this.renderLoginComponentForFlows()),u.a.createElement("div",{className:"sumra-terms-privacy"},"By using either Sign Up or Login you agree to our ",u.a.createElement("br",null),u.a.createElement("a",{href:"#"},"Terms & Privacy Policy."))))}}s()(B,"replaces","LoginComponent");var A=a(89),D=a(156),M=a(190),V=a(101),R=a(1891),H=a.n(R);const W=/^[0-9()\-\s]*$/;var q;!function(e){e.Email="login_field_email",e.MatrixId="login_field_mxid",e.Phone="login_field_phone",e.Password="login_field_phone"}(q||(q={}));class K extends u.a.PureComponent{constructor(e){super(e),s()(this,"onForgotPasswordClick",e=>{e.preventDefault(),e.stopPropagation(),this.props.onForgotPasswordClick()}),s()(this,"onSubmitForm",async e=>{e.preventDefault();if(!await this.verifyFieldsBeforeSubmit())return void w.a.instance.track("onboarding_registration_submit_failed");let t="",a=null,r=null;switch(this.state.loginType){case q.Email:case q.MatrixId:t=this.props.username;break;case q.Phone:a=this.props.phoneCountry,r=this.props.phoneNumber}this.props.onSubmit(t,a,r,this.state.password)}),s()(this,"onUsernameChanged",e=>{this.props.onUsernameChanged(e.target.value)}),s()(this,"onUsernameFocus",()=>{this.state.loginType===q.MatrixId?w.a.instance.track("onboarding_login_mxid_focus"):w.a.instance.track("onboarding_login_email_focus")}),s()(this,"onUsernameBlur",e=>{this.state.loginType===q.MatrixId?w.a.instance.track("onboarding_login_mxid_blur"):w.a.instance.track("onboarding_login_email_blur"),this.props.onUsernameBlur(e.target.value)}),s()(this,"onLoginTypeChange",e=>{const t=e.target.value;this.setState({loginType:t}),this.props.onUsernameChanged(""),w.a.instance.track("onboarding_login_type_changed",{loginType:t})}),s()(this,"onPhoneCountryChanged",e=>{this.props.onPhoneCountryChanged(e.iso2)}),s()(this,"onPhoneNumberChanged",e=>{this.props.onPhoneNumberChanged(e.target.value)}),s()(this,"onPhoneNumberFocus",()=>{w.a.instance.track("onboarding_login_phone_number_focus")}),s()(this,"onPhoneNumberBlur",e=>{w.a.instance.track("onboarding_login_phone_number_blur")}),s()(this,"onPasswordChanged",e=>{this.setState({password:e.target.value})}),s()(this,"validateUsernameRules",Object(D.a)({rules:[{key:"required",test:({value:e,allowEmpty:t})=>t||!!e,invalid:()=>Object(l.a)("Enter username")}]})),s()(this,"onUsernameValidate",async e=>{const t=await this.validateUsernameRules(e);return this.markFieldValid(q.MatrixId,t.valid),t}),s()(this,"validateEmailRules",Object(D.a)({rules:[{key:"required",test:({value:e,allowEmpty:t})=>t||!!e,invalid:()=>Object(l.a)("Enter email address")},{key:"email",test:({value:e})=>!e||M.a(e),invalid:()=>Object(l.a)("Doesn't look like a valid email address")}]})),s()(this,"onEmailValidate",async e=>{const t=await this.validateEmailRules(e);return this.markFieldValid(q.Email,t.valid),t}),s()(this,"validatePhoneNumberRules",Object(D.a)({rules:[{key:"required",test:({value:e,allowEmpty:t})=>t||!!e,invalid:()=>Object(l.a)("Enter phone number")},{key:"number",test:({value:e})=>!e||W.test(e),invalid:()=>Object(l.a)("That phone number doesn't look quite right, please check and try again")}]})),s()(this,"onPhoneNumberValidate",async e=>{const t=await this.validatePhoneNumberRules(e);return this.markFieldValid(q.Password,t.valid),t}),s()(this,"validatePasswordRules",Object(D.a)({rules:[{key:"required",test:({value:e,allowEmpty:t})=>t||!!e,invalid:()=>Object(l.a)("Enter password")}]})),s()(this,"onPasswordValidate",async e=>{const t=await this.validatePasswordRules(e);return this.markFieldValid(q.Password,t.valid),t}),this.state={fieldValid:{},loginType:q.MatrixId,password:""}}async verifyFieldsBeforeSubmit(){const e=document.activeElement;e&&e.blur();const t=[this.state.loginType,q.Password];for(const e of t){const t=this[e];t&&await t.validate({allowEmpty:!1})}if(await new Promise(e=>this.setState({},e)),this.allFieldsValid())return!0;const a=this.findFirstInvalidField(t);return!a||(a.focus(),a.validate({allowEmpty:!1,focused:!0}),!1)}allFieldsValid(){const e=Object.keys(this.state.fieldValid);for(let t=0;t<e.length;++t)if(!this.state.fieldValid[e[t]])return!1;return!0}findFirstInvalidField(e){for(const t of e)if(!this.state.fieldValid[t]&&this[t])return this[t];return null}markFieldValid(e,t){const{fieldValid:a}=this.state;a[e]=t,this.setState({fieldValid:a})}renderLoginField(e,t){const a={error:!1};switch(e){case q.Email:return a.error=this.props.loginIncorrect&&!this.props.username,u.a.createElement(V.a,{className:v()(a),name:"username",key:"email_input",type:"text",label:Object(l.a)("Email"),placeholder:"joe@example.com",value:this.props.username,onChange:this.onUsernameChanged,onFocus:this.onUsernameFocus,onBlur:this.onUsernameBlur,disabled:this.props.disableSubmit,autoFocus:t,onValidate:this.onEmailValidate,ref:e=>this[q.Email]=e});case q.MatrixId:return a.error=this.props.loginIncorrect&&!this.props.username,u.a.createElement("fieldset",{className:"sumra-input-fieldset"},u.a.createElement("input",{type:"text",placeholder:"Enter username",value:this.props.username,onChange:this.onUsernameChanged}));case q.Phone:{a.error=this.props.loginIncorrect&&!this.props.phoneNumber;const e=O.getComponent("views.auth.CountryDropdown"),r=u.a.createElement(e,{value:this.props.phoneCountry,isSmall:!0,showPrefix:!0,onOptionChange:this.onPhoneCountryChanged});return u.a.createElement(V.a,{className:v()(a),name:"phoneNumber",key:"phone_input",type:"text",label:Object(l.a)("Phone"),value:this.props.phoneNumber,prefixComponent:r,onChange:this.onPhoneNumberChanged,onFocus:this.onPhoneNumberFocus,onBlur:this.onPhoneNumberBlur,disabled:this.props.disableSubmit,autoFocus:t,onValidate:this.onPhoneNumberValidate,ref:e=>this[q.Password]=e})}}}isLoginEmpty(){switch(this.state.loginType){case q.Email:case q.MatrixId:return!this.props.username;case q.Phone:return!this.props.phoneCountry||!this.props.phoneNumber}}render(){let e;this.props.onForgotPasswordClick&&(e=u.a.createElement(A.a,{className:"mx_Login_forgot",disabled:this.props.busy,kind:"link",onClick:this.onForgotPasswordClick},Object(l.a)("Forgot password?")));v()({error:this.props.loginIncorrect&&!this.isLoginEmpty()});const t=!this.isLoginEmpty(),a=this.renderLoginField(this.state.loginType,!t);let r;return d.a.get().disable_3pid_login||(r=u.a.createElement("div",{className:"mx_Login_type_container"},u.a.createElement("label",{className:"mx_Login_type_label"},Object(l.a)("Sign in with")),u.a.createElement(V.a,{element:"select",value:this.state.loginType,onChange:this.onLoginTypeChange,disabled:this.props.disableSubmit},u.a.createElement("option",{key:q.MatrixId,value:q.MatrixId},Object(l.a)("Username")),u.a.createElement("option",{key:q.Email,value:q.Email},Object(l.a)("Email address")),u.a.createElement("option",{key:q.Password,value:q.Password},Object(l.a)("Phone"))))),u.a.createElement("div",null,u.a.createElement("form",{onSubmit:this.onSubmitForm},a,u.a.createElement("fieldset",{className:"sumra-input-fieldset"},u.a.createElement("input",{type:"password",placeholder:"Enter password",value:this.state.password,onChange:this.onPasswordChanged}),u.a.createElement("img",{className:"sumra-input-fieldset-icon",src:H.a})),u.a.createElement("button",{className:"sumra-Button",type:"submit",disabled:this.props.disableSubmit,style:{marginTop:"25px"}},u.a.createElement("span",null,"Sign up"))))}}s()(K,"replaces","PasswordLogin"),s()(K,"defaultProps",{onUsernameChanged:function(){},onUsernameBlur:function(){},onPhoneCountryChanged:function(){},onPhoneNumberChanged:function(){},loginIncorrect:!1,disableSubmit:!1});var G=a(1892),J=a.n(G);a(1893);const $="https://api.sumra.net/",X="auth/v1/registration";async function z(e,t){return fetch($+e,{body:JSON.stringify(t),method:"POST",headers:{"Content-Type":"application/json"}})}a(1894),a(1897);var Q=a(1898),Y=a.n(Q),Z=a(1899),ee=a.n(Z),te=a(1900),ae=a.n(te),re=a(1901),se=a.n(re);function ne(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function oe(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ne(Object(a),!0).forEach((function(t){s()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ne(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}class ie extends m.Component{constructor(e){super(e),s()(this,"_changeInput",e=>{const t=e.target.value;this.setState({username:t})}),s()(this,"_submitUserForm",async e=>{e.preventDefault();const t=await z(X,{code:this.props.verificationCode,username:this.state.username,app_uid:"chat.sumra.web"}),a=await t.json();a.success||this.setState({invalidUserName:!0,error_message:a.error_message}),a.success&&(localStorage.setItem("mx_hs_url","https://syn.sumra.net/"),localStorage.setItem("mx_is_url","https://syn.sumra.net/"),localStorage.setItem("mx_device_id",a.data.device_id),localStorage.setItem("mx_user_id",a.data.user_id),localStorage.setItem("mx_access_token",a.data.access_token),localStorage.setItem("mx_crypto_initialised",!0),location.href=location.origin+"/#/home",location.reload())});const{state:t}=this.props;this.state=oe(oe({},t),{},{username:"",invalidUserName:!1,password:"",error_message:""}),this.timerID=null}render(){const{invalidUserName:e,username:t}=this.state,a=O.getComponent("auth.AuthBody"),r=O.getComponent("views.auth.AuthPage");let s,n,o,i;return t?(i="sumra-input-fieldset available",n=ee.a,e?(o=ae.a,s=u.a.createElement("div",{className:"sumra-input-message error"},this.state.error_message)):(o=se.a,s=u.a.createElement("div",{className:"sumra-input-message success"},"This username is available."))):(i="sumra-input-fieldset",n=Y.a,o=null,s=null),u.a.createElement(r,null,u.a.createElement(a,null,u.a.createElement(T,null),u.a.createElement("div",{className:"sumra-create-username-box"},u.a.createElement("h1",{className:"sumra-create-username-title"},"Create Username"),u.a.createElement("div",{className:"sumra-create-username-text"},"Please provide following details for your new account"),u.a.createElement("form",null,u.a.createElement("fieldset",{className:i},u.a.createElement("input",{type:"text",placeholder:"Enter username",onChange:this._changeInput}),u.a.createElement("img",{className:"sumra-input-fieldset-icon-right",src:o,width:"22"})),s,u.a.createElement("button",{className:"sumra-Button",onClick:this._submitUserForm},u.a.createElement("span",null,"Sign Up")))),u.a.createElement("div",{className:"sumra-terms-privacy"},"By using either Sign Up or Login you agree to our ",u.a.createElement("br",null),u.a.createElement("a",{href:"#"},"Terms & Privacy Policy."))))}}class le extends m.Component{constructor(e){super(e),s()(this,"_submitVerificationCode",e=>{e.preventDefault();const{verificationCode:t}=this.state,{fields:a}=this.props;t.length===a&&this.setState({verificationComplete:!0})}),s()(this,"_handleChange",e=>{console.log("handleChange: "+e)}),s()(this,"_handleComplete",e=>{this.setState({verificationCode:e})}),s()(this,"_resendCodeOnPhone",e=>{e.preventDefault();z("auth/v1/send-code",{phone_number:localStorage.getItem("href").replace("+",""),app_uid:"chat.sumra.web"}).then(e=>console.log,e=>console.error)}),this.state={verificationCode:"",verificationComplete:!1},this.input=Object(m.createRef)()}render(){const{type:e,fieldWidth:t,fieldHeight:a,fields:r}=this.props,s=O.getComponent("auth.AuthBody"),n=O.getComponent("views.auth.AuthPage"),o=localStorage.getItem("href");let i=localStorage.getItem("messenger");const l="+"===o[0],c=i.length;return l&&(i=i.substr(0,c-10)+" "+i.substr(-10,4)+" "+i.substr(-6,6)),u.a.createElement(u.a.Fragment,null,this.state.verificationComplete?u.a.createElement(ie,{verificationCode:this.state.verificationCode}):u.a.createElement(n,null,u.a.createElement(s,null,u.a.createElement(T,null),u.a.createElement("div",{className:"sumra-verify-box"},u.a.createElement("h1",{className:"sumra-verify-title "},"Verify Account!"),u.a.createElement("form",null,u.a.createElement("div",{className:"sumra-verify-text "},"Enter 6 digit verification code we have sent to  ",l?u.a.createElement("a",{href:"#",onClick:this._resendCodeOnPhone},i):u.a.createElement("a",{href:o},i)),u.a.createElement(J.a,{className:"sumra-react-code-input",ref:this.input,type:e,fieldWidth:t,fieldHeight:a,onChange:this._handleChange,onComplete:this._handleComplete}),u.a.createElement("div",null,u.a.createElement("span",{className:"sumra-verify-didntreceive"},"Didn't receive our code?"),l?u.a.createElement("a",{href:"#",onClick:this._resendCodeOnPhone},u.a.createElement("span",{className:"sumra-verify-resend"},"Resend Code")):u.a.createElement("a",{href:o},u.a.createElement("span",{className:"sumra-verify-resend"},"Resend Code"))),u.a.createElement("button",{className:"sumra-Button",onClick:this._submitVerificationCode},u.a.createElement("span",null,"Continue")))),u.a.createElement("div",{className:"sumra-terms-privacy"},"By using either Sign Up or Login you agree to our ",u.a.createElement("br",null),u.a.createElement("a",{href:"#"},"Terms & Privacy Policy.")))))}}s()(le,"replaces","Registration"),s()(le,"defaultProps",{autoFocus:!0,fieldWidth:38,fieldHeight:44,type:"text",fields:6});class ce extends u.a.PureComponent{render(){return u.a.createElement("div",null,this.props.children)}}s()(ce,"replaces","AuthBody");a(1902);class me extends u.a.PureComponent{render(){return u.a.createElement("div",{className:"sumra-main"},this.props.children)}}s()(me,"replaces","AuthPage");a(1903);var ue=a(2016),he=a.n(ue),de=a(2061),pe=a.n(de),ge=a(1904),be=a(1906),ve=a.n(be),fe=(a(1907),a(1908),a(1909)),ye=a.n(fe),Ee=(a(1910),a(1911)),we=a.n(Ee),Ce=a(1912),_e=a.n(Ce);a(1913),a(1914),a(1915);var Se=[{image:ve.a,title:"Telegram",href:"https://t.me/sumrabot",hrefMobile:"tg://resolve?domain=SumraBot"},{image:ye.a,title:"WhatsApp",href:"https://api.whatsapp.com/send/?phone=14155238886&text=join%20stage-nine&app_absent=0",hrefMobile:"https://wa.me/14155238886"},{image:_e.a,title:"Discord",href:"https://discord.com/invite/75xbhgmbvP",hrefMobile:"https://discord.com/invite/75xbhgmbvP"},{image:we.a,title:"Line",href:"https://page.line.me/?liff.state=%3FaccountId%3D772dmcwu%26openerPlatform%3Dnative%26openerKey%3Dtalkroom%253Amessage",hrefMobile:"line://ti/p/@772dmcwu"}],xe=a(1916),Pe=a.n(xe),Oe=a(2006),Ne=(a(1917),a(429)),ke=a.n(Ne),je=a(1918),Ie=a.n(je),Le=a(1919),Te=a.n(Le),Fe=a(1920),Ue=a.n(Fe);ke.a.use([Ne.Pagination,Ne.Autoplay]);var Be=()=>u.a.createElement(Oe.Swiper,{className:"swiper-container",grabCursor:!0,pagination:{clickable:!0},autoplay:{delay:3e4}},u.a.createElement(Oe.SwiperSlide,{className:"swiper-slide"},u.a.createElement("div",{className:"sumra-wallet-slide",style:{backgroundImage:`linear-gradient(180deg, rgba(29, 29, 29, 0.24) 0%, rgba(29, 29, 29, 0.33) 30.21%, rgba(10, 10, 10, 0.675) 89.58%),url(${Te.a})`}},u.a.createElement("div",{className:"sutisfied-clients"},u.a.createElement("img",{src:Ue.a,alt:"quotes"}),u.a.createElement("span",null,"what users are saying about us")),u.a.createElement("div",{className:"sumra-welcome-testimonials "},'"Excellent application! It helps to stay in touch with your siblings if you are abroad.',u.a.createElement("br",null),'Looking forward to many more innovative features and functions."'),u.a.createElement("div",{className:"sumra-testimonials-author "},"Harriet Andersson"))),u.a.createElement(Oe.SwiperSlide,{className:"swiper-slide"},u.a.createElement("div",{className:"sumra-wallet-slide",style:{backgroundImage:`linear-gradient(180deg, rgba(23, 19, 63, 0) 32.29%, rgba(20, 20, 20, 0.9) 100%),url(${Ie.a})`}},u.a.createElement("div",{className:"sutisfied-clients"},u.a.createElement("img",{src:Ue.a,alt:"quotes"}),u.a.createElement("span",null,"what users are saying about us")),u.a.createElement("div",{className:"sumra-welcome-testimonials "},'"The aplication is very simple, even my mom can use it alone. ',u.a.createElement("br",null),' Easy to communicate with friends all over the world."'),u.a.createElement("div",{className:"sumra-testimonials-author "},"Alfred Bianco"))));Object(l.b)("Sign in with SSO");class Ae extends u.a.PureComponent{constructor(e){super(e),s()(this,"_changePhoneNumber",e=>{this.setState({phone:e})}),s()(this,"_goToLoginPage",()=>{this.props.onStep(4)}),s()(this,"_goToVeryfycationCodePage",e=>{const t=e.target.alt,a=e.target.parentElement.href;localStorage.setItem("messenger",t),localStorage.setItem("href",a),location.href=location.origin+"/#/register"}),s()(this,"_submitPhoneNumber",e=>{e.preventDefault();let{phone:t}=this.state;localStorage.setItem("messenger",t),localStorage.setItem("href",t),t&&(t=t.replace("+",""),this.setState({phone:t}),z("auth/v1/send-code",{phone_number:t,app_uid:"chat.sumra.web"}).then(e=>console.log,e=>console.error),location.href=location.origin+"/#/register")}),this.state={phone:""},w.a.instance.track("onboarding_welcome"),this.state={phone:""}}render(){const e=O.getComponent("views.auth.AuthPage"),t=O.getComponent("auth.AuthBody"),a=Se.map((e,t)=>{let a="";return a=ge.isMobile?e.hrefMobile:e.href,u.a.createElement("li",{key:t,onClick:this._goToVeryfycationCodePage},u.a.createElement("a",{href:a,target:"_blank",rel:"noreferrer"},u.a.createElement("img",{src:e.image,width:46,alt:e.title})))});return u.a.createElement(e,null,u.a.createElement(t,null,u.a.createElement("div",{className:"sumra-welcome-carousel"},u.a.createElement(Be,null)),u.a.createElement("div",{className:"sumra-welcome-carousel"},u.a.createElement(Be,null)),u.a.createElement("div",{className:"sumra-welcome-main"},u.a.createElement(T,null),u.a.createElement("div",{className:"sumra-auth-form"},u.a.createElement("section",{className:"sumra-auth-login"},u.a.createElement("h1",{className:"h1-stitle"},"Sign Up or Login"),u.a.createElement("h2",null,"Start by using your ",u.a.createElement("b",null," Messenger:")),u.a.createElement("ul",{className:"sumra-auth-messengers"},a)),u.a.createElement("div",{className:"sumra-line"},"or"),u.a.createElement("section",null,u.a.createElement("h2",null,"Start by using your ",u.a.createElement("b",null,"Mobile phone")," "),u.a.createElement("form",null,u.a.createElement("fieldset",{className:"sumra-phone-fieldset"},u.a.createElement(he.a,{flags:pe.a,placeholder:"Enter phone number",value:this.state.phone,onChange:this._changePhoneNumber}),u.a.createElement("div",{className:"sumra-phone-send",onClick:this._submitPhoneNumber},u.a.createElement("img",{src:Pe.a}))))),u.a.createElement("section",{className:"sumra-button-section"},u.a.createElement("div",{className:"sumra-line"},"or"),u.a.createElement("a",{className:"sumra-Button",href:"/#/login"},u.a.createElement("span",null,"Login with Sumra ID")))),u.a.createElement("div",{className:"sumra-terms-privacy"},"By using either Sign Up or Login you agree to our",u.a.createElement("br",null),u.a.createElement("a",{href:"#"},"Terms & Privacy Policy.")))))}}s()(Ae,"replaces","Welcome");const De=()=>{const e=d.a.get().branding;let t=[{text:"Blog",url:"https://element.io/blog"},{text:"Twitter",url:"https://twitter.com/element_hq"},{text:"GitHub",url:"https://github.com/vector-im/element-web"}];e&&e.authFooterLinks&&(t=e.authFooterLinks);const a=[];for(const e of t)a.push(u.a.createElement("a",{href:e.url,key:e.text,target:"_blank",rel:"noreferrer noopener"},e.text));return u.a.createElement("div",{className:"mx_AuthFooter"},a,u.a.createElement("a",{href:"https://matrix.org",target:"_blank",rel:"noreferrer noopener"},Object(l.a)("Powered by Matrix")))};De.replaces="AuthFooter";var Me=De,Ve=a(86),Re=a.n(Ve);class He extends u.a.PureComponent{render(){const e=d.a.get().branding;let t="themes/element/img/logos/Sumra_Chat_Logo.svg";return e&&e.authHeaderLogoUrl&&(t=e.authHeaderLogoUrl),u.a.createElement("div",{className:"mx_AuthHeaderLogo"},u.a.createElement("img",{src:t,alt:"Sumra"}))}}s()(He,"replaces","AuthHeaderLogo"),s()(He,"propTypes",{icon:Re.a.string});var We=a(2064),qe=a.n(We);let Ke={};c&&(Ke["structures.VectorEmbeddedPage"]=c),B&&(Ke["structures.auth.SumraLogin"]=B),K&&(Ke["views.auth.SumraPasswordLogin"]=K),j&&(Ke["views.elements.SSOButtons"]=j),le&&(Ke["structures.auth.SumraConfirmCodeForm"]=le),ce&&(Ke["views.auth.SumraAuthBody"]=ce),me&&(Ke["views.auth.SumraAuthPage"]=me),ie&&(Ke["views.auth.SumraUserCreateForm"]=ie),Ae&&(Ke["views.auth.SumraWelcome"]=Ae),Me&&(Ke["views.auth.VectorAuthFooter"]=Me),He&&(Ke["views.auth.VectorAuthHeaderLogo"]=He),qe.a&&(Ke["views.auth.indexedDB"]=qe.a),Se&&(Ke["views.auth.socialLinks"]=Se)},428:function(e,t){e.exports="images/sumra/logo.86bca89.svg"}}]);
//# sourceMappingURL=element-web-component-index.js.map